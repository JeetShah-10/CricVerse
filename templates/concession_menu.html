{% extends 'base.html' %}
{% block title %}{{ concession.name }} Menu ‚Ä¢ CricVerse{% endblock %}
{% block content %}

<section class="position-relative rounded-3 overflow-hidden mb-5 shadow-lg" data-aos="zoom-in">
  <img src="https://images.unsplash.com/photo-1526318472351-c75fcf070305?q=80&w=1600&auto=format&fit=crop" class="w-100 object-fit-cover h-100" alt="Concession backdrop" style="filter: brightness(75%);">
  <div class="position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center">
    <div class="container px-4 text-white">
      <h1 class="display-4 fw-bold mb-2">{{ concession.name }}</h1>
      <div class="fs-5 text-opacity-75">{{ concession.category }} ‚Ä¢ {{ concession.location_zone }} Zone</div>
      <div class="fs-5 text-opacity-75">Open All Day ‚Ä¢ 100% Vegetarian</div>
    </div>
  </div>
</section>

<div class="container px-4">
  <div class="row g-5">
    <div class="col-lg-8">
      <!-- Recommended Combos Section -->
      <div class="card shadow-lg mb-5" data-aos="fade-up">
        <div class="card-header bg-primary text-white p-4 rounded-top-3">
          <h5 class="card-title fs-5 fw-semibold mb-1">üçΩÔ∏è {{ concession.category }} Special Combos</h5>
          <small class="text-white-75">Exclusive deals with real savings on popular combinations</small>
        </div>
        <div class="card-body p-4">
          <div class="row row-cols-1 row-cols-md-2 g-4" id="comboSection">
            <!-- Combos will be dynamically generated based on concession type -->
          </div>
        </div>
      </div>

      <!-- Menu Items Section -->
      <div class="card shadow-lg mb-5" data-aos="fade-up">
        <div class="card-header p-4 border-bottom border-secondary-subtle">
          <h4 class="card-title fs-4 fw-semibold mb-1">Menu Items</h4>
          <small class="text-muted">All items are 100% vegetarian ‚Ä¢ Click + to add to your order</small>
        </div>
        <div class="card-body p-4">
          <form id="orderForm" method="post" action="{{ url_for('place_order') }}">
            <input type="hidden" name="concession_id" value="{{ concession.id }}">
            
            {% for item in menu_items %}
            <div class="card mb-4 shadow-sm rounded-3 overflow-hidden transition-all duration-300 hover:scale-[1.01] hover:shadow-xl" data-aos="fade-up" data-aos-delay="{{ loop.index0 * 50 }}">
              <div class="row g-0">
                <!-- Food Image -->
                <div class="col-md-4">
                  <div class="w-100 h-100 overflow-hidden rounded-top-3 rounded-md-start rounded-md-top-0">
                    {% set food_img = 
                      'https://images.unsplash.com/photo-1565299624946-b28f40a0ca4b?q=80&w=400&auto=format&fit=crop' if 'burger' in item.name|lower else
                      'https://images.unsplash.com/photo-1513104890138-7c749659a591?q=80&w=400&auto=format&fit=crop' if 'pizza' in item.name|lower else
                      'https://images.unsplash.com/photo-1546173159-315724a31696?q=80&w=400&auto=format&fit=crop' if 'drink' in item.category|lower or 'beverage' in item.category|lower else
                      'https://images.unsplash.com/photo-1565958011703-44f9829ba187?q=80&w=400&auto=format&fit=crop' if 'salad' in item.name|lower else
                      'https://images.unsplash.com/photo-1551024709-8f23befc6f87?q=80&w=400&auto=format&fit=crop' if 'dessert' in item.category|lower else
                      'https://images.unsplash.com/photo-1504674900247-0877df9cc836?q=80&w=400&auto=format&fit=crop' %}
                    <img src="{{ food_img }}" alt="{{ item.name }}" class="w-100 h-100 object-fit-cover transition-transform duration-300 hover:scale-105">
                  </div>
                </div>
                
                <!-- Item Details -->
                <div class="col-md-8 p-4 d-flex flex-column justify-content-between">
                  <div>
                    <h5 class="fw-semibold fs-5 mb-2">{{ item.name }}</h5>
                    <p class="text-muted mb-3">{{ item.description }}</p>
                    <div class="d-flex align-items-center gap-2 mb-3">
                      <span class="badge bg-primary text-primary-emphasis rounded-pill fs-6">{{ item.category }}</span>
                      <span class="badge bg-success text-success-emphasis rounded-pill fs-6">Vegetarian</span>
                      {% if item.is_available %}
                        <span class="badge bg-success text-success-emphasis rounded-pill fs-6">Available</span>
                      {% else %}
                        <span class="badge bg-danger text-danger-emphasis rounded-pill fs-6">Unavailable</span>
                      {% endif %}
                    </div>
                  </div>
                  
                  <!-- Quantity Controls -->
                  <div class="d-flex align-items-center justify-content-between gap-3 mt-4">
                    <div class="d-flex align-items-center gap-2">
                      <button type="button" class="btn btn-outline-secondary rounded-circle d-flex align-items-center justify-content-center fw-bold transition-all duration-200 quantity-btn" style="width: 40px; height: 40px;" data-action="decrease" aria-label="Decrease quantity">
                        <i class="bi bi-dash-lg"></i>
                      </button>
                      <input type="number" name="quantities" value="0" min="0" max="10" 
                             class="form-control text-center fw-bold rounded-pill quantity-input" style="width: 60px; height: 40px;"
                             data-price="{{ item.price }}" 
                             data-item-name="{{ item.name }}"
                             aria-label="Quantity for {{ item.name }}">
                      <button type="button" class="btn btn-outline-secondary rounded-circle d-flex align-items-center justify-content-center fw-bold transition-all duration-200 quantity-btn" style="width: 40px; height: 40px;" data-action="increase" aria-label="Increase quantity">
                        <i class="bi bi-plus-lg"></i>
                      </button>
                    </div>
                    <span class="fw-bold fs-4 text-success">‚Çπ{{ item.price|int }}</span>
                  </div>
                  
                  <input type="hidden" name="selected_items" value="{{ item.name }}">
                </div>
              </div>
            </div>
            {% endfor %}
            
            <div class="text-center mt-5">
              <button type="submit" class="btn btn-success btn-lg rounded-pill shadow-sm transition-colors duration-300" id="placeOrderBtn" disabled>
                <i class="bi bi-cart-check me-2"></i>Proceed to Checkout
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
    
    <!-- Order Summary Sidebar -->
    <div class="col-lg-4">
      <div class="card shadow-lg sticky-top" style="top: 1.5rem;" data-aos="fade-left">
        <div class="card-header bg-success text-white p-4 rounded-top-3">
          <h5 class="card-title fs-5 fw-semibold mb-0"><i class="bi bi-cart3 me-2"></i>Order Summary</h5>
        </div>
        <div class="card-body p-4">
          <!-- Empty State -->
          <div id="emptyState" class="text-center py-4">
            <div class="fs-1 mb-3">üõí</div>
            <h6 class="text-muted">No items selected</h6>
            <p class="text-muted small">Add items from the menu to start your order</p>
          </div>
          
          <!-- Order Items -->
          <div id="orderSummary" class="d-none">
            <div id="orderItems"></div>
            <hr class="my-4 border-secondary-subtle">
            
            <!-- Price Breakdown -->
            <div class="space-y-2">
              <div class="d-flex justify-content-between align-items-center">
                <span class="text-muted">Subtotal:</span>
                <span id="subtotal">‚Çπ0</span>
              </div>
              <div class="d-flex justify-content-between align-items-center">
                <span class="text-muted">Service Charge (5%):</span>
                <span id="serviceCharge">‚Çπ0</span>
              </div>
              <div class="d-flex justify-content-between align-items-center">
                <span class="text-muted">Tax (18%):</span>
                <span id="tax">‚Çπ0</span>
              </div>
              <hr class="my-4 border-secondary-subtle">
              <div class="d-flex justify-content-between align-items-center">
                <h5 class="fs-5 fw-bold">Total:</h5>
                <h4 class="fs-4 text-success fw-bold" id="totalAmount">‚Çπ0</h4>
              </div>
            </div>
            
            <!-- Quick Actions -->
            <div class="mt-4">
              <button class="btn btn-outline-secondary w-100 mb-2" id="clearOrder">
                <i class="bi bi-trash me-2"></i>Clear Order
              </button>
              <button class="btn btn-success w-100" id="saveOrder">
                <i class="bi bi-bookmark me-2"></i>Save for Later
              </button>
            </div>
          </div>
          
          <input type="hidden" name="total_amount" id="totalAmountInput" value="0">
        </div>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Initialize combos first
  generateCombos();
  
  const quantityInputs = document.querySelectorAll('.quantity-input');
  const totalAmount = document.getElementById('totalAmount');
  const totalAmountInput = document.getElementById('totalAmountInput');
  const placeOrderBtn = document.getElementById('placeOrderBtn');
  const orderSummary = document.getElementById('orderSummary');
  const emptyState = document.getElementById('emptyState');
  const orderItems = document.getElementById('orderItems');
  const subtotalEl = document.getElementById('subtotal');
  const serviceChargeEl = document.getElementById('serviceCharge');
  const taxEl = document.getElementById('tax');
  
  function updateOrderSummary() {
    let subtotal = 0;
    let summaryItems = [];
    
    quantityInputs.forEach((input, index) => {
      const quantity = parseInt(input.value) || 0;
      const price = parseFloat(input.dataset.price);
      const itemName = input.dataset.itemName;
      
      if (quantity > 0) {
        const itemTotal = quantity * price;
        subtotal += itemTotal;
        summaryItems.push({
          name: itemName,
          quantity: quantity,
          price: price,
          total: itemTotal
        });
      }
    });
    
    // Calculate fees
    const serviceCharge = Math.round(subtotal * 0.05);
    const tax = Math.round(subtotal * 0.18);
    const total = subtotal + serviceCharge + tax;
    
    // Update display
    subtotalEl.textContent = `‚Çπ${Math.round(subtotal)}`;
    serviceChargeEl.textContent = `‚Çπ${serviceCharge}`;
    taxEl.textContent = `‚Çπ${tax}`;
    totalAmount.textContent = `‚Çπ${Math.round(total)}`;
    totalAmountInput.value = Math.round(total);
    
    // Show/hide empty state
    if (summaryItems.length > 0) {
      emptyState.classList.add('d-none');
      orderSummary.classList.remove('d-none');
      
      // Update order items
      let itemsHTML = '';
      summaryItems.forEach(item => {
        itemsHTML += `
          <div class="d-flex justify-content-between align-items-center mb-3 p-3 rounded bg-light">
            <div class="flex-grow-1">
              <div class="fw-medium">${item.name}</div>
              <div class="text-muted small">${item.quantity}x @ ‚Çπ${Math.round(item.price)}</div>
            </div>
            <span class="fw-bold text-success">‚Çπ${Math.round(item.total)}</span>
          </div>
        `;
      });
      orderItems.innerHTML = itemsHTML;
    } else {
      emptyState.classList.remove('d-none');
      orderSummary.classList.add('d-none');
    }
    
    // Enable/disable place order button
    placeOrderBtn.disabled = total === 0;
  }
  
  // Quantity button handlers
  document.querySelectorAll('.quantity-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      const input = this.parentElement.querySelector('.quantity-input');
      const action = this.dataset.action;
      let value = parseInt(input.value) || 0;
      
      if (action === 'increase') {
        value = Math.min(value + 1, 10);
      } else if (action === 'decrease') {
        value = Math.max(value - 1, 0);
      }
      
      input.value = value;
      updateOrderSummary();
    });
  });
  
  // Direct input change handler
  quantityInputs.forEach(input => {
    input.addEventListener('input', updateOrderSummary);
  });
  
  // Clear order button
  document.getElementById('clearOrder').addEventListener('click', function() {
    quantityInputs.forEach(input => {
      input.value = 0;
    });
    updateOrderSummary();
  });
  
  // Save order button
  document.getElementById('saveOrder').addEventListener('click', function() {
    alert('Order saved to favorites!');
  });
  
  // Form validation
  document.getElementById('orderForm').addEventListener('submit', function(e) {
    const total = parseFloat(totalAmountInput.value);
    if (total <= 0) {
      e.preventDefault();
      alert('Please select at least one item to order.');
      return false;
    }
  });
});

// Combo functionality
function generateCombos() {
  const concessionCategory = '{{ concession.category }}'.toLowerCase();
  const comboSection = document.getElementById('comboSection');
  let combos = [];
  
  // Define combos based on concession category
  if (concessionCategory.includes('burger')) {
    combos = [
      {
        name: "Classic Burger Combo",
        description: "Burger + Fries + Soft Drink",
        items: ["Veggie Classic", "French Fries", "Soft Drink"],
        originalPrice: 933,
        comboPrice: 825,
        savings: 108,
        badge: "Best Value",
        badgeColor: "green"
      },
      {
        name: "Deluxe Meal",
        description: "Burger + Fries + Milkshake + Side Salad",
        items: ["Veggie Stack", "French Fries", "Milkshake", "Side Salad"],
        originalPrice: 1263,
        comboPrice: 1100,
        savings: 163,
        badge: "Popular",
        badgeColor: "yellow"
      }
    ];
  } else if (concessionCategory.includes('pizza')) {
    combos = [
      {
        name: "Pizza & Sides Combo",
        description: "Pizza Slice + Garlic Bread + Soft Drink",
        items: ["Pizza Slice", "Garlic Bread", "Soft Drink"],
        originalPrice: 11.97,
        comboPrice: 9.99,
        savings: 1.98,
        badge: "Best Value",
        badgeColor: "green"
      },
      {
        name: "Family Feast",
        description: "Large Pizza + Breadsticks + Caesar Salad + 2 Drinks",
        items: ["Veggie Supreme", "Breadsticks", "Caesar Salad", "Soft Drink", "Soft Drink"],
        originalPrice: 32.96,
        comboPrice: 28.99,
        savings: 3.97,
        badge: "Family Deal",
        badgeColor: "primary"
      }
    ];
  } else if (concessionCategory.includes('beverage') || concessionCategory.includes('coffee')) {
    combos = [
      {
        name: "Coffee & Pastry",
        description: "Espresso + Cookie + Water",
        items: ["Espresso", "Cookie", "Water"],
        originalPrice: 8.47,
        comboPrice: 6.99,
        savings: 1.48,
        badge: "Morning Special",
        badgeColor: "green"
      },
      {
        name: "Smoothie Combo",
        description: "Smoothie + Granola Bar + Coconut Water",
        items: ["Smoothie", "Granola Bar", "Coconut Water"],
        originalPrice: 16.47,
        comboPrice: 13.99,
        savings: 2.48,
        badge: "Healthy Choice",
        badgeColor: "yellow"
      }
    ];
  } else if (concessionCategory.includes('snack')) {
    combos = [
      {
        name: "Movie Night Pack",
        description: "Popcorn + Nachos + Soft Drink",
        items: ["Popcorn", "Nachos", "Soft Drink"],
        originalPrice: 13.97,
        comboPrice: 11.99,
        savings: 1.98,
        badge: "Entertainment",
        badgeColor: "green"
      },
      {
        name: "Healthy Snack Pack",
        description: "Nuts + Fruit Cup + Water",
        items: ["Nuts", "Fruit Cup", "Water"],
        originalPrice: 9.47,
        comboPrice: 7.99,
        savings: 1.48,
        badge: "Nutritious",
        badgeColor: "yellow"
      }
    ];
  } else if (concessionCategory.includes('dessert')) {
    combos = [
      {
        name: "Sweet Treat Combo",
        description: "Ice Cream + Cookie + Hot Chocolate",
        items: ["Ice Cream Cone", "Cookie", "Hot Chocolate"],
        originalPrice: 12.97,
        comboPrice: 10.99,
        savings: 1.98,
        badge: "Sweet Deal",
        badgeColor: "green"
      },
      {
        name: "Dessert Delight",
        description: "Cheesecake + Coffee + Water",
        items: ["Cheesecake", "Espresso", "Water"],
        originalPrice: 18.47,
        comboPrice: 15.99,
        savings: 2.48,
        badge: "Premium",
        badgeColor: "primary"
      }
    ];
  } else if (concessionCategory.includes('healthy')) {
    combos = [
      {
        name: "Power Bowl Combo",
        description: "Quinoa Bowl + Green Smoothie + Water",
        items: ["Quinoa Bowl", "Green Smoothie", "Water"],
        originalPrice: 20.47,
        comboPrice: 17.99,
        savings: 2.48,
        badge: "Power Pack",
        badgeColor: "green"
      },
      {
        name: "Fresh Start",
        description: "Garden Salad + Juice + Granola",
        items: ["Garden Salad", "Juice", "Granola"],
        originalPrice: 17.97,
        comboPrice: 14.99,
        savings: 2.98,
        badge: "Fresh & Clean",
        badgeColor: "yellow"
      }
    ];
  } else if (concessionCategory.includes('meal')) {
    combos = [
      {
        name: "Complete Meal",
        description: "Rice Bowl + Soup + Soft Drink",
        items: ["Rice Bowl", "Soup", "Soft Drink"],
        originalPrice: 19.97,
        comboPrice: 16.99,
        savings: 2.98,
        badge: "Complete",
        badgeColor: "green"
      },
      {
        name: "Asian Fusion",
        description: "Stir Fry + Noodle Bowl + Green Tea",
        items: ["Stir Fry", "Noodle Bowl", "Green Tea"],
        originalPrice: 25.47,
        comboPrice: 21.99,
        savings: 3.48,
        badge: "Asian Special",
        badgeColor: "primary"
      }
    ];
  } else if (concessionCategory.includes('grill')) {
    combos = [
      {
        name: "Grill Master",
        description: "Grilled Vegetables + Portobello + Water",
        items: ["Grilled Vegetables", "Portobello Mushroom", "Water"],
        originalPrice: 22.47,
        comboPrice: 19.99,
        savings: 2.48,
        badge: "Grill Special",
        badgeColor: "green"
      },
      {
        name: "BBQ Combo",
        description: "BBQ Vegetables + Grilled Corn + Soft Drink",
        items: ["BBQ Vegetables", "Grilled Corn", "Soft Drink"],
        originalPrice: 16.97,
        comboPrice: 14.99,
        savings: 1.98,
        badge: "BBQ Deal",
        badgeColor: "yellow"
      }
    ];
  } else if (concessionCategory.includes('sandwich')) {
    combos = [
      {
        name: "Lunch Combo",
        description: "Sandwich + Chips + Soft Drink",
        items: ["Veggie Delight", "Chips", "Soft Drink"],
        originalPrice: 13.97,
        comboPrice: 11.99,
        savings: 1.98,
        badge: "Lunch Special",
        badgeColor: "green"
      },
      {
        name: "Premium Wrap",
        description: "Falafel Wrap + Hummus + Water",
        items: ["Falafel Wrap", "Hummus", "Water"],
        originalPrice: 16.47,
        comboPrice: 13.99,
        savings: 2.48,
        badge: "Premium",
        badgeColor: "primary"
      }
    ];
  }
  
  // Generate combo HTML
  if (combos.length > 0) {
    let comboHTML = '';
    combos.forEach((combo, index) => {
      comboHTML += `
        <div class="col-span-1">
          <div class="combo-card p-4 rounded-xl border border-slate-200 dark:border-slate-700 bg-light-card dark:bg-dark-card transition-all duration-300 hover:translate-y-[-2px] hover:shadow-xl relative overflow-hidden group">
            <div class="flex items-center mb-2">
              <span class="px-3 py-1 rounded-full text-xs font-medium 
                ${combo.badgeColor === 'green' ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100' :
                combo.badgeColor === 'yellow' ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-100' :
                'bg-primary-100 text-primary-800 dark:bg-primary-900 dark:text-primary-100'}
                mr-2">${combo.badge}</span>
              <span class="text-muted small">Save ‚Çπ${combo.savings}</span>
            </div>
            <h6 class="text-lg font-semibold mb-1 text-light-text dark:text-dark-text">${combo.name}</h6>
            <p class="text-light-subtext dark:text-dark-subtext text-sm mb-2">${combo.description}</p>
            <div class="mb-2">
              <small class="line-through text-muted">‚Çπ${combo.originalPrice}</small>
              <span class="fw-bold fs-4 text-success ms-2">‚Çπ${combo.comboPrice}</span>
            </div>
            <div class="flex justify-between items-center">
              <small class="text-light-subtext dark:text-dark-subtext">${combo.items.length} items</small>
              <button type="button" class="px-4 py-2 text-sm font-medium text-green-600 border border-green-600 hover:bg-green-600 hover:text-white rounded-md transition-all duration-200 hover:scale-105" onclick="addComboItems(${index})">
                <i class="bi bi-plus mr-1"></i>Add Combo
              </button>
            </div>
            <div class="absolute inset-0 bg-gradient-to-r from-transparent via-green-500/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none"></div>
          </div>
        </div>
      `;
    });
    comboSection.innerHTML = comboHTML;
  } else {
    comboSection.innerHTML = `
      <div class="col-span-full text-center text-light-subtext dark:text-dark-subtext py-4">
        <div class="text-5xl mb-3">üçΩÔ∏è</div>
        <h6 class="text-xl font-semibold">No combos available for this concession type</h6>
        <p class="text-sm">Please order items individually from the menu below</p>
      </div>
    `;
  }
}

function addComboItems(comboIndex) {
  const concessionCategory = '{{ concession.category }}'.toLowerCase();
  let combos = [];
  
  // Recreate the same combo logic to get the items
  if (concessionCategory.includes('burger')) {
    combos = [
      {
        items: ["Veggie Classic", "French Fries", "Soft Drink"],
        comboPrice: 14.99
      },
      {
        items: ["Veggie Stack", "French Fries", "Milkshake", "Side Salad"],
        comboPrice: 19.99
      }
    ];
  } else if (concessionCategory.includes('pizza')) {
    combos = [
      {
        items: ["Pizza Slice", "Garlic Bread", "Soft Drink"],
        comboPrice: 9.99
      },
      {
        items: ["Veggie Supreme", "Breadsticks", "Caesar Salad", "Soft Drink", "Soft Drink"],
        comboPrice: 28.99
      }
    ];
  } else if (concessionCategory.includes('beverage') || concessionCategory.includes('coffee')) {
    combos = [
      {
        items: ["Espresso", "Cookie", "Water"],
        comboPrice: 6.99
      },
      {
        items: ["Smoothie", "Granola Bar", "Coconut Water"],
        comboPrice: 13.99
      }
    ];
  } else if (concessionCategory.includes('snack')) {
    combos = [
      {
        items: ["Popcorn", "Nachos", "Soft Drink"],
        comboPrice: 11.99
      },
      {
        items: ["Nuts", "Fruit Cup", "Water"],
        comboPrice: 7.99
      }
    ];
  } else if (concessionCategory.includes('dessert')) {
    combos = [
      {
        items: ["Ice Cream Cone", "Cookie", "Hot Chocolate"],
        comboPrice: 10.99
      },
      {
        items: ["Cheesecake", "Espresso", "Water"],
        comboPrice: 15.99
      }
    ];
  } else if (concessionCategory.includes('healthy')) {
    combos = [
      {
        items: ["Quinoa Bowl", "Green Smoothie", "Water"],
        comboPrice: 17.99
      },
      {
        items: ["Garden Salad", "Juice", "Granola"],
        comboPrice: 14.99
      }
    ];
  } else if (concessionCategory.includes('meal')) {
    combos = [
      {
        items: ["Rice Bowl", "Soup", "Soft Drink"],
        comboPrice: 16.99
      },
      {
        items: ["Stir Fry", "Noodle Bowl", "Green Tea"],
        comboPrice: 21.99
      }
    ];
  } else if (concessionCategory.includes('grill')) {
    combos = [
      {
        items: ["Grilled Vegetables", "Portobello Mushroom", "Water"],
        comboPrice: 19.99
      },
      {
        items: ["BBQ Vegetables", "Grilled Corn", "Soft Drink"],
        comboPrice: 14.99
      }
    ];
  } else if (concessionCategory.includes('sandwich')) {
    combos = [
      {
        items: ["Veggie Delight", "Chips", "Soft Drink"],
        comboPrice: 11.99
      },
      {
        items: ["Falafel Wrap", "Hummus", "Water"],
        comboPrice: 13.99
      }
    ];
  }
  
  if (combos[comboIndex]) {
    const combo = combos[comboIndex];
    const inputs = document.querySelectorAll('.quantity-input');
    let addedItems = 0;
    
    // Find and add each combo item
    combo.items.forEach(itemName => {
      inputs.forEach(input => {
        const inputItemName = input.dataset.itemName;
        if (inputItemName.toLowerCase().includes(itemName.toLowerCase()) || 
            itemName.toLowerCase().includes(inputItemName.toLowerCase())) {
          const currentValue = parseInt(input.value) || 0;
          input.value = Math.min(currentValue + 1, 10);
          addedItems++;
        }
      });
    });
    
    if (addedItems > 0) {
      // Trigger update
      const event = new Event('input');
      inputs.forEach(input => {
        if (input.value > 0) {
          input.dispatchEvent(event);
        }
      });
      
      // Show success message
      const alertDiv = document.createElement('div');
      alertDiv.className = 'alert alert-success alert-dismissible fade show position-fixed top-0 end-0 m-3 z-index-9999' ; // Bootstrap alert classes
      alertDiv.setAttribute('role', 'alert');
      alertDiv.innerHTML = `
        <i class="bi bi-check-circle me-2"></i>Combo added to cart! Total: ‚Çπ${combo.comboPrice}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      `;
      document.body.appendChild(alertDiv);
      
      // Auto-remove after 3 seconds
      setTimeout(() => {
        if (alertDiv.parentNode) {
          alertDiv.remove();
        }
      }, 3000);
    } else {
      alert('Sorry, some combo items are not available in the current menu. Please add items individually.');
    }
  }
}


</script>

{% endblock %}