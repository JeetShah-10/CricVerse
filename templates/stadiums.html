{% extends 'base.html' %}

{% block title %}Stadiums â€¢ CricVerse{% endblock %}

{% block head %}
<style>
    @import url('https://fonts.googleapis.com/css2?family=Exo+2:wght@700&family=Roboto:wght@400;500&display=swap');

    :root {
        --primary-dark: #0D1B2A;
        --secondary-dark: #1B263B;
        --accent-blue: #415A77;
        --accent-light: #E0E1DD;
        --accent-glow: #00C6FF;
    }

    body { 
        background-color: var(--primary-dark);
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%231B263B' fill-opacity='0.4'%3E%3Cpath d='M0 38.59l2.83-2.83 1.41 1.41L1.41 40H0v-1.41zM0 1.4l2.83 2.83 1.41-1.41L1.41 0H0v1.41zM38.59 40l-2.83-2.83 1.41-1.41L40 38.59V40h-1.41zM40 1.41l-2.83 2.83-1.41-1.41L38.59 0H40v1.41z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
    }

    .hero-stadiums {
        background-size: 110% 110%;
        transition: background-position 0.5s ease-out;
        position: relative;
    }

    .scroll-indicator {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        animation: bounce 2s infinite;
    }

    @keyframes bounce {
        0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
        40% { transform: translateY(-10px); }
        60% { transform: translateY(-5px); }
    }

    .stadium-card-link {
        display: block;
        text-decoration: none;
        color: inherit;
        perspective: 1000px;
    }

    .stadium-card {
        transition: transform 0.5s, box-shadow 0.5s;
        transform-style: preserve-3d;
    }

    .stadium-card-link:hover .stadium-card {
        transform: rotateY(10deg) rotateX(10deg);
        box-shadow: 0 15px 35px rgba(0,0,0,0.4);
    }
</style>
{% endblock %}

{% block content %}
<div class="hero-stadiums" style="background-image: url('{{ url_for('static', filename='img/Stadium Image.jpg') }}'); height: 70vh; background-position: center;">
    <div class="h-100 d-flex justify-content-center align-items-center text-center text-white">
        <div>
            <h1 class="display-3 fw-bold">The Arenas of Glory</h1>
            <p class="lead">Where legends are forged and history is written.</p>
        </div>
        <div class="scroll-indicator text-white">
            <i class="bi bi-chevron-down fs-2"></i>
        </div>
    </div>
</div>

<div class="container my-5">
    <div class="row g-4">
        {% for stadium in stadiums %}
        <div class="col-lg-4 col-md-6 stadium-item" {% if loop.index > 6 %}style="display: none;"{% endif %}>
            <a href="{{ url_for('stadium_detail', stadium_id=stadium.id) }}" class="stadium-card-link">
                <div class="card bg-dark text-white h-100 stadium-card">
                    <img src="{{ stadium.image_url or url_for('static', filename='img/Stadium Image.jpg') }}" class="card-img-top" alt="{{ stadium.name }}">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">{{ stadium.name }}</h5>
                        <p class="card-text"><i class="bi bi-geo-alt-fill me-2"></i>{{ stadium.location }}</p>
                        <p class="card-text"><i class="bi bi-people-fill me-2"></i>Capacity: {{ "{:,}".format(stadium.capacity) }}</p>
                        <div class="mt-auto">
                            {% if stadium.pitch_type %}<span class="badge bg-info me-2">{{ stadium.pitch_type }}</span>{% endif %}
                            <div class="text-end text-white-50">View Details <i class="bi bi-arrow-right-circle ms-2"></i></div>
                        </div>
                    </div>
                </div>
            </a>
        </div>
        {% endfor %}
    </div>
    <div class="text-center mt-5">
        <button id="load-more" class="btn btn-lg btn-outline-light">
            <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true" style="display: none;"></span>
            Load More
        </button>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', () => {
    const hero = document.querySelector('.hero-stadiums');
    hero.addEventListener('mousemove', (e) => {
        const { clientX: x, clientY: y } = e;
        const { offsetWidth: width, offsetHeight: height } = hero;
        const xPos = (x / width - 0.5) * 20;
        const yPos = (y / height - 0.5) * 20;
        hero.style.backgroundPosition = `calc(50% + ${xPos}px) calc(50% + ${yPos}px)`;
    });

    const loadMoreBtn = document.getElementById('load-more');
    const spinner = loadMoreBtn.querySelector('.spinner-border');
    loadMoreBtn.addEventListener('click', () => {
        spinner.style.display = 'inline-block';
        loadMoreBtn.disabled = true;

        setTimeout(() => {
            const hiddenItems = document.querySelectorAll('.stadium-item[style*="display: none;"]');
            hiddenItems.forEach((item, index) => {
                if (index < 6) {
                    item.style.animation = 'fadeIn 0.5s ease-in-out';
                    item.style.display = 'block';
                }
            });
            if (document.querySelectorAll('.stadium-item[style*="display: none;"]').length === 0) {
                loadMoreBtn.style.display = 'none';
            }
            spinner.style.display = 'none';
            loadMoreBtn.disabled = false;
        }, 500);
    });
});
</script>
<style>
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}
</style>
{% endblock %}